!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";__webpack_require__(5),__webpack_require__(1),__webpack_require__(2),__webpack_require__(3),__webpack_require__(6),__webpack_require__(7);var configClient=__webpack_require__(4);angular.module("ui-layout-events",["ui.layout"]).directive("uiLayout",["$timeout","$rootScope",function($timeout,$rootScope){function fireEvent(){timer&&$timeout.cancel(timer),timer=$timeout(function(){$rootScope.$broadcast("ui.layout.resize"),timer=null},0)}var timer,methods=["updateDisplay","toggleBefore","toggleAfter","mouseUpHandler","mouseMoveHandler"];return{restrict:"AE",require:"^uiLayout",link:function(scope,elem,attrs,uiLayoutCtrl){angular.forEach(methods,function(method){var oldFn=uiLayoutCtrl[method];uiLayoutCtrl[method]=function(){oldFn.apply(uiLayoutCtrl,arguments),fireEvent()}})}}}]),angular.module("Physics.editable",["xeditable"]).run(["editableOptions",function(editableOptions){editableOptions.theme="bs3"}]).controller("editableController",["$scope",function($scope){$scope.editables={},$scope.afterSave=function(data){"undefined"!=typeof $scope.onAfterSave&&$scope.onAfterSave()}}]),angular.module("Autodesk.ADN.Physics.Main",["ngRoute","ui.layout","ui-layout-events","Physics.editable","Autodesk.ADN.MongoSample.View.Viewer","Autodesk.ADN.MongoSample.Dialog.Navbar","Autodesk.ADN.Toolkit.UI.Directive.SpinningImg","Autodesk.ADN.Toolkit.ViewData.Service.ViewAndData"]).config(["$routeProvider","ViewAndDataProvider",function($routeProvider,ViewAndDataProvider){ViewAndDataProvider.setTokenUrl(configClient.ApiURL+"/token"),$routeProvider.otherwise({redirectTo:"/viewer"})}]).controller("Autodesk.ADN.Physics.Main.Controller",["$scope",function($scope){$scope.$on("app.EmitMessage",function(event,data){$scope.$broadcast(data.msgId,data.msgArgs)})}])},function(module,exports,__webpack_require__){"use strict";angular.module("Autodesk.ADN.Toolkit.UI.Directive.SpinningImg",[]).directive("adnSpinningImg",["$interval",function($interval){function link(scope,element,attrs){function update(){angle+=parseFloat(attrs.step),angle%=360;var value="rotateY("+angle+"deg)";jQuery(element).css({transform:value,"-moz-transform":value,"-webkit-transform":value,"-ms-transform":value,"-o-transform":value})}var angle=0;$interval(function(){update()},parseInt(attrs.period))}return{restrict:"E",replace:!0,template:"<img height={{height}}width={{width}}src={{src}}style={{style}}>",link:link}}])},function(module,exports,__webpack_require__){"use strict";angular.module("Autodesk.ADN.Toolkit.Directive.Viewer",[]).directive("adnViewerContainer",function(){function link($scope,$element,$attributes){$scope.viewerFactory=new Autodesk.ADN.Toolkit.Viewer.ViewerFactory($attributes.url,$attributes.hasOwnProperty("config")?JSON.parse($attributes.config):{}),$scope.viewerFactory.onInitialized(function(){$scope.$broadcast("factoryInitialized",{viewerFactory:$scope.viewerFactory}),$scope.onViewerFactoryInitialized({factory:$scope.viewerFactory}),$attributes.$observe("urn",function(urn){urn.length&&$scope.viewerFactory.getViewablePath(urn,function(pathInfoCollection){$scope.onViewablePath({pathInfoCollection:pathInfoCollection}),$scope.$broadcast("forceApply",{})},function(error){$scope.onError({error:error})})})})}function controller($scope){this.getViewerFactory=function(){return $scope.viewerFactory}}return controller.$inject=["$scope"],{scope:{url:"@",urn:"@",onViewablePath:"&",onViewerFactoryInitialized:"&",onError:"&"},link:link,replace:!0,restrict:"E",transclude:!0,controller:controller,template:'<div style="overflow:auto;position:relative;{{style}}"><div ng-transclude></div><div/>'}}).directive("adnViewer",function(){function postlink($scope,$element,$attributes,parentController){function onFactoryInitialized(viewerFactory){var config=$attributes.hasOwnProperty("config")?JSON.parse($attributes.config):{};$scope.viewer=viewerFactory.createViewer($element[0],config),$scope.onViewerInitialized({viewer:$scope.viewer}),$scope.$on("$destroy",function(){$scope.onDestroy({viewer:$scope.viewer})}),$scope.$on("forceApply",function(event,data){$scope.$apply()}),$attributes.$observe("path",function(path){path.length&&($scope.viewer.load(path),$scope.onPathLoaded({viewer:$scope.viewer,path:path}))})}$scope.viewer=null;var viewerFactory=parentController.getViewerFactory();viewerFactory?onFactoryInitialized(viewerFactory):$scope.$on("factoryInitialized",function(event,data){onFactoryInitialized(data.viewerFactory)})}return{scope:{path:"@",onDestroy:"&",onPathLoaded:"&",onViewerInitialized:"&",onError:"&"},link:{post:postlink},restrict:"E",replace:!0,require:"^adnViewerContainer",template:'<div style="overflow:auto;position:relative;{{style}}"> <div/>'}})},function(module,exports,__webpack_require__){"use strict";var config=__webpack_require__(4);angular.module("Autodesk.ADN.Toolkit.ViewData.Service.ViewAndData",[]).provider("ViewAndData",{tokenUrl:"",setTokenUrl:function(url){this.tokenUrl=url},$get:function(){return{client:new Autodesk.ADN.Toolkit.ViewAndData.Client(config.viewAndDataUrl,this.tokenUrl)}}})},function(module,exports,__webpack_require__){"use strict";var configClient={host:"/node/physics",viewAndDataUrl:"https://developer.api.autodesk.com"};configClient.ApiURL="http://"+window.location.host+configClient.host+"/api",module.exports=configClient},function(module,exports,__webpack_require__){"use strict";__webpack_require__(8),__webpack_require__(9),__webpack_require__(10);var configClient=__webpack_require__(4);angular.module("Autodesk.ADN.MongoSample.View.Viewer",["ngRoute","Autodesk.ADN.Toolkit.Directive.Viewer"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/viewer",{templateUrl:"./js/ui/views/viewer/viewer.html",controller:"Autodesk.ADN.MongoSample.View.Viewer.Controller"})}]).controller("Autodesk.ADN.MongoSample.View.Viewer.Controller",["$scope","$http","$compile","ViewAndData",function($scope,$http,$compile,ViewAndData){function getClientSize(){var w=window,d=document,e=d.documentElement,g=d.getElementsByTagName("body")[0],sx=w.innerWidth||e.clientWidth||g.clientWidth,sy=w.innerHeight||e.clientHeight||g.clientHeight;return{x:sx,y:sy}}function initialize(){$scope.viewer=null,$scope.selectedPath=[],$scope.selectedModel=null,$scope.viewerContainerConfig={environment:"AutodeskProduction"},$scope.viewerConfig={height:"1000px",lightPreset:8,viewerType:"GuiViewer3D",qualityLevel:[!0,!0],navigationTool:"freeorbit",progressiveRendering:!0,backgroundColor:[3,4,5,250,250,250]},$scope.$on("ui.layout.resize",function(event,data){setTimeout(resize,350)}),$(window).resize(resize),resize()}function resize(){var size=getClientSize();$("#main-container").height(size.y-80),$scope.viewer&&($scope.viewerConfig.height=size.y-80+"px",$($scope.viewer.container).height(size.y-80),$scope.viewer.resize())}function getGravity(){return _gravity}function onGeometryLoaded(){$scope.viewer.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,onGeometryLoaded),$scope.viewer.loadExtension("Autodesk.ADN.Viewing.Extension.Physics",{compile:compile,getGravity:getGravity}),$scope.viewer.loadExtension("Autodesk.ADN.Viewing.Extension.TransformTool")}function compile(html){return $compile(html)($scope)}$scope.tokenUrl=configClient.ApiURL+"/token",$scope.searchFilter=function(model){var regExp=new RegExp($scope.modelsFilterValue,"i");return!$scope.modelsFilterValue||regExp.test(model.name)},$scope.onViewablePath=function(pathInfoCollection){$scope.selectedPath=[pathInfoCollection.path3d[0].path]},$scope.onViewerFactoryInitialized=function(factory){$http.get(configClient.host+"/api/models").then(function(response){$scope.models=response.data,$scope.models.forEach(function(model){model.thumbnail="resources/img/adsk.png";var fileId=ViewAndData.client.fromBase64(model.urn);ViewAndData.client.getThumbnail(fileId,function(data){model.thumbnail="data:image/png;base64,"+data})}),$scope.onModelSelected($scope.models[0])})},$scope.onPathLoaded=function(viewer,path){};var _gravity={x:0,y:0,z:-9.8};$scope.$on("event.Gravity",function(event,data){_gravity=data.gravity?{x:0,y:0,z:-9.8}:{x:0,y:0,z:0}}),$scope.onViewerInitialized=function(viewer){$scope.viewer=viewer,resize(),viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,onGeometryLoaded)},$scope.onModelSelected=function(model){$scope.selectedModel&&$scope.selectedModel._id===model._id||($scope.selectedModel=model,$scope.selectedPath=[])},$scope.onDestroy=function(viewer){viewer.finish(),viewer=null,$scope.viewer=null},initialize()}])},function(module,exports,__webpack_require__){"use strict";angular.module("Autodesk.ADN.MongoSample.Dialog.Navbar",["Autodesk.ADN.MongoSample.Dialog.About"]).controller("Autodesk.ADN.MongoSample.Dialog.Navbar.Controller",["$scope",function($scope){$scope.brand="View & Data API - Physics",$scope.brandImg="resources/img/adsk/adsk-32x32-32.png";var gravity=!0;$scope.gravity="Disable Gravity",$scope.aboutItems=[{text:"Get an API key",href:"http://developer.autodesk.com",icon:"glyphicon glyphicon-check"},{text:"API Support",href:"http://forums.autodesk.com/t5/Web-Services-API/ct-p/94",icon:"glyphicon glyphicon-thumbs-up"},{text:"Autodesk",href:"http://www.autodesk.com",icon:"glyphicon glyphicon-text-background"},{"class":"divider"},{text:"Source on Github",href:"https://github.com/Developer-Autodesk/physics-view.and.data.api",icon:"glyphicon glyphicon-floppy-save"},{text:"About that sample",href:"",icon:"glyphicon glyphicon-info-sign",onClick:function(){$("#aboutDlg").modal("show")}}],$scope.toggleGravity=function(){gravity=!gravity,$scope.gravity=(gravity?"Disable":"Enable")+" Gravity",$scope.$emit("app.EmitMessage",{msgId:"event.Gravity",msgArgs:{gravity:gravity}})}}])},function(module,exports,__webpack_require__){"use strict";angular.module("Autodesk.ADN.MongoSample.Dialog.About",[]).controller("Autodesk.ADN.MongoSample.Dialog.About.Controller",["$scope",function($scope){$scope.author="Philippe Leefsma"}])},function(module,exports,__webpack_require__){"use strict";var _Object$create=__webpack_require__(11)["default"];AutodeskNamespace("Autodesk.ADN.Viewing.Extension"),Autodesk.ADN.Viewing.Extension.Treeview=function(viewer,options){function initializeTree(viewer){function createNode(tree,parentNode,component){var icon=component.children?"resources/img/tree/parent.png":"resources/img/tree/child.png",nodeData={text:component.name,id:component.dbId,icon:icon},node=tree.create_node(parentNode,nodeData,"last",!1,!1);return node}function buildTreeRec(tree,parentNode,component){if(component.children)for(var children=component.children,i=0;i<children.length;i++){var childComponent=children[i],childNode=createNode(tree,parentNode,childComponent);childComponent.children&&buildTreeRec(tree,childNode,childComponent)}}var tree=$("#tree").jstree({core:{check_callback:!0}});tree.on("ready.jstree",function(e,data){var treeRef=$("#tree").jstree(!0);viewer.getObjectTree(function(result){var rootComponent=result.root,rootNode=createNode(treeRef,"#",rootComponent);buildTreeRec(treeRef,rootNode,rootComponent),$("#tree").jstree("open_node",rootNode)})}),tree.on("before.jstree",function(e,data){}),tree.on("changed.jstree",function(e,data){}),tree.on("select_node.jstree",function(event,data){data.node}),tree.on("dblclick.jstree",function(event){var ids=$("#tree").jstree("get_selected"),dbId=parseInt(ids[0]);viewer.isolate(dbId),viewer.fitToView(dbId)})}Autodesk.Viewing.Extension.call(this,viewer,options);var _self=this;_self.load=function(){return console.log("Autodesk.ADN.Viewing.Extension.Treeview loaded"),$("#tree-container").append('<div id="tree"> </div>'),initializeTree(viewer),!0},_self.unload=function(){return console.log("Autodesk.ADN.Viewing.Extension.Treeview unloaded"),$("#tree").remove(),!0}},Autodesk.ADN.Viewing.Extension.Treeview.prototype=_Object$create(Autodesk.Viewing.Extension.prototype),Autodesk.ADN.Viewing.Extension.Treeview.prototype.constructor=Autodesk.ADN.Viewing.Extension.Treeview,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ADN.Viewing.Extension.Treeview",Autodesk.ADN.Viewing.Extension.Treeview)},function(module,exports,__webpack_require__){"use strict";var _Object$create=__webpack_require__(11)["default"];AutodeskNamespace("Autodesk.ADN.Viewing.Extension"),Autodesk.ADN.Viewing.Extension.Physics=function(viewer,options){function parseArray(str,separator){var array=str.split(separator),result=[];return array.forEach(function(element){result.push(parseFloat(element))}),result}function updateMeshTransform(body){var mesh=body.mesh,transform=body.getCenterOfMassTransform(),origin=transform.getOrigin(),q=transform.getRotation();mesh.matrixWorld.makeRotationFromQuaternion({x:q.x(),y:q.y(),z:q.z(),w:q.w()}),mesh.matrixWorld.setPosition(new THREE.Vector3(origin.x(),origin.y(),origin.z()))}function getMeshPosition(mesh){var pos=new THREE.Vector3;return pos.setFromMatrixPosition(mesh.matrixWorld),pos}function createCollisionShape(mesh){for(var geometry=mesh.geometry,hull=new Ammo.btConvexHullShape,vertexBuffer=geometry.vb,i=0;i<vertexBuffer.length;i+=geometry.vbstride)hull.addPoint(new Ammo.btVector3(vertexBuffer[i],vertexBuffer[i+1],vertexBuffer[i+2]));return hull}function createRigidBody(entry){var localInertia=new Ammo.btVector3(0,0,0),shape=createCollisionShape(entry.mesh);shape.calculateLocalInertia(entry.mass,localInertia);var transform=new Ammo.btTransform;transform.setIdentity();var position=getMeshPosition(entry.mesh);transform.setOrigin(new Ammo.btVector3(position.x,position.y,position.z));var q=new THREE.Quaternion;q.setFromRotationMatrix(entry.mesh.matrixWorld),transform.setRotation(new Ammo.btQuaternion(q.x,q.y,q.z,q.w));var motionState=new Ammo.btDefaultMotionState(transform),rbInfo=new Ammo.btRigidBodyConstructionInfo(entry.mass,motionState,shape,localInertia),body=new Ammo.btRigidBody(rbInfo);return body.setLinearVelocity(new Ammo.btVector3(entry.vLinear[0],entry.vLinear[1],entry.vLinear[2])),body.setAngularVelocity(new Ammo.btVector3(entry.vAngular[0],entry.vAngular[1],entry.vAngular[2])),body.mesh=entry.mesh,body}function newGuid(){var d=(new Date).getTime(),guid="xxxx-xxxx-xxxx-xxxx-xxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:7&r|8).toString(16)});return guid}Autodesk.Viewing.Extension.call(this,viewer,options);var _fps=null,_self=this,_panel=null,_world=null,_meshMap={},_viewer=viewer,_started=!1,_running=!1,_animationId=null,_selectedEntry=null,Stopwatch=function(){var _startTime=(new Date).getTime();this.start=function(){_startTime=(new Date).getTime()},this.getElapsedMs=function(){var elapsedMs=(new Date).getTime()-_startTime;return _startTime=(new Date).getTime(),elapsedMs}},_stopWatch=new Stopwatch;String.prototype.replaceAll=function(find,replace){return this.replace(new RegExp(find.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),replace)},_self.load=function(){return _self.initialize(function(){_panel=_self.loadPanel(),_viewer.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,_self.onItemSelected),console.log("Autodesk.ADN.Viewing.Extension.Physics loaded")}),!0},_self.unload=function(){return $("#physicsDivId").remove(),_panel.setVisible(!1,!0),_panel=null,_self.stop(),console.log("Autodesk.ADN.Viewing.Extension.Physics unloaded"),!0},_self.initialize=function(callback){_viewer.getObjectTree(function(rootComponent){rootComponent.children.forEach(function(component){var fragIdsArray=Array.isArray(component.fragIds)?component.fragIds:[component.fragIds];fragIdsArray.forEach(function(subFragId){var mesh=_viewer.impl.getRenderProxy(_viewer,subFragId);_viewer.getPropertyValue(component.dbId,"Mass",function(mass){mass="undefined"!==mass?mass:1,_viewer.getPropertyValue(component.dbId,"vInit",function(vInit){vInit="undefined"!==vInit?vInit:"0;0;0",vInit=parseArray(vInit,";"),_meshMap[subFragId]={transform:mesh.matrixWorld.clone(),component:component,vAngularInit:[0,0,0],vAngular:[0,0,0],vLinearInit:vInit,vLinear:vInit,mass:mass,mesh:mesh,body:null}})})})}),callback()})},_self.displayVelocity=function(vLinear,vAngular){var editable=angular.element($("#editableDivId")).scope();editable.editables.vx=parseFloat(vLinear[0].toFixed(3)),editable.editables.vy=parseFloat(vLinear[1].toFixed(3)),editable.editables.vz=parseFloat(vLinear[2].toFixed(3)),editable.editables.ax=parseFloat(vAngular[0].toFixed(3)),editable.editables.ay=parseFloat(vAngular[1].toFixed(3)),editable.editables.az=parseFloat(vAngular[2].toFixed(3))},_self.onItemSelected=function(event){var dbId=event.dbIdArray[0];if("undefined"==typeof dbId)return void $("#editableDivId").css("visibility","collapse");$("#editableDivId").css("visibility","visible");var fragId=event.fragIdsArray[0],fragIdsArray=Array.isArray(fragId)?fragId:[fragId],subFragId=fragIdsArray[0],vLinear=_meshMap[subFragId].vLinear,vAngular=_meshMap[subFragId].vAngular;_self.displayVelocity(vLinear,vAngular),_selectedEntry=_meshMap[subFragId]},_self.loadPanel=function(){Autodesk.ADN.Viewing.Extension.Physics.ControlPanel=function(parentContainer,id,title,content,x,y){this.content=content,Autodesk.Viewing.UI.DockingPanel.call(this,parentContainer,id,"",{shadow:!0}),this.container.style.top=y+"px",this.container.style.left=x+"px",this.container.style.width="auto",this.container.style.height="auto",this.container.style.resize="none"},Autodesk.ADN.Viewing.Extension.Physics.ControlPanel.prototype=_Object$create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.ADN.Viewing.Extension.Physics.ControlPanel.prototype.constructor=Autodesk.ADN.Viewing.Extension.Physics.ControlPanel,Autodesk.ADN.Viewing.Extension.Physics.ControlPanel.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.closer=this.createCloseButton(),this.container.appendChild(this.title),this.container.appendChild(this.content),this.initializeMoveHandlers(this.title)};var content=document.createElement("div");content.id="physicsDivId";var panel=new Autodesk.ADN.Viewing.Extension.Physics.ControlPanel(_viewer.container,"Physics","Physics",content,0,0);$("#physicsDivId").css("color","white"),panel.setVisible(!0);var format='<a href="#" editable-number="editables.%1" e-step="any" e-style="width:100px" onaftersave="afterSave()">{{editables.%1}}</a>',html='<button id="startBtnId" type="button" style="color:#000000;width:100px">Start</button><button id="resetBtnId" type="button" style="color:#000000;width:100px">Reset</button><div id="editableDivId" ng-controller="editableController" style="visibility: collapse"><br><br>&nbsp Linear Velocity: <br> &nbsp Vx = '+format.replaceAll("%1","vx")+"<br> &nbsp Vy = "+format.replaceAll("%1","vy")+"<br> &nbsp Vz = "+format.replaceAll("%1","vz")+"<br><br>&nbsp Angular Velocity: <br> &nbsp Ax = "+format.replaceAll("%1","ax")+"<br> &nbsp Ay = "+format.replaceAll("%1","ay")+"<br> &nbsp Az = "+format.replaceAll("%1","az")+"</div>",element=options.compile(html);$("#physicsDivId").append(element),_self.displayVelocity([0,0,0],[0,0,0]);var editable=angular.element($("#editableDivId")).scope();return editable.onAfterSave=function(){var editables=editable.editables;_selectedEntry.vAngular=[editables.ax,editables.ay,editables.az],_selectedEntry.vLinear=[editables.vx,editables.vy,editables.vz],_started||(_selectedEntry.vAngularInit=_selectedEntry.vAngular,_selectedEntry.vLinearInit=_selectedEntry.vLinear)},_fps=new FPSMeter(content,{smoothing:10,show:"fps",toggleOn:"click",decimals:1,zIndex:999,left:"5px",top:"60px",theme:"transparent",heat:1,graph:1,history:32}),$("#startBtnId").click(function(){_animationId?($("#startBtnId").text("Start"),_self.stop()):($("#startBtnId").text("Stop"),_self.start())}),$("#resetBtnId").click(function(){_running&&($("#startBtnId").text("Start"),_self.stop()),_self.reset()}),panel},_self.createWorld=function(){var collisionConfiguration=new Ammo.btDefaultCollisionConfiguration,world=new Ammo.btDiscreteDynamicsWorld(new Ammo.btCollisionDispatcher(collisionConfiguration),new Ammo.btDbvtBroadphase,new Ammo.btSequentialImpulseConstraintSolver,collisionConfiguration),gravity=options.getGravity();return console.log(gravity),world.setGravity(new Ammo.btVector3(gravity.x,gravity.y,gravity.z)),world},_self.start=function(){_viewer.select([]),_viewer.setView(_viewer.getCurrentView()),_world=_self.createWorld();for(var key in _meshMap){var entry=_meshMap[key],body=createRigidBody(entry);_world.addRigidBody(body),entry.body=body}_running=!0,_started=!0,_stopWatch.getElapsedMs(),_self.update()},_self.stop=function(){for(var key in _meshMap){var entry=_meshMap[key],va=entry.body.getAngularVelocity(),vl=entry.body.getLinearVelocity();entry.vAngular=[va.x(),va.y(),va.z()],entry.vLinear=[vl.x(),vl.y(),vl.z()]}_running=!1},_self.update=function(){if(!_running)return cancelAnimationFrame(_animationId),void(_animationId=null);_animationId=requestAnimationFrame(_self.update);var dt=.002*_stopWatch.getElapsedMs();dt=dt>.5?.5:dt,_world.stepSimulation(dt,10);for(var key in _meshMap)updateMeshTransform(_meshMap[key].body);_viewer.impl.invalidate(!0),_fps.tick()},_self.reset=function(){for(var key in _meshMap){var entry=_meshMap[key];entry.mesh.matrixWorld=entry.transform.clone(),entry.vAngular=entry.vAngularInit,entry.vLinear=entry.vLinearInit}_viewer.impl.invalidate(!0),_started=!1},viewer.getPropertyValue=function(dbId,displayName,callback){function _cb(result){if(result.properties){for(var i=0;i<result.properties.length;i++){var prop=result.properties[i];if(prop.displayName===displayName)return void callback(prop.displayValue)}callback("undefined")}}this.getProperties(dbId,_cb)},viewer.getCurrentView=function(viewname){var view={id:newGuid(),name:viewname,position:this.navigation.getPosition(),target:this.navigation.getTarget(),fov:this.getFOV(),up:this.navigation.getCameraUpVector(),worldUp:this.navigation.getWorldUpVector(),explode:this.getExplodeScale()};return view},viewer.setView=function(view){viewer.explode(view.explode),this.navigation.setRequestTransitionWithUp(!0,new THREE.Vector3(view.position.x,view.position.y,view.position.z),new THREE.Vector3(view.target.x,view.target.y,view.target.z),view.fov,new THREE.Vector3(view.up.x,view.up.y,view.up.z)),this.resize()}},Autodesk.ADN.Viewing.Extension.Physics.prototype=_Object$create(Autodesk.Viewing.Extension.prototype),Autodesk.ADN.Viewing.Extension.Physics.prototype.constructor=Autodesk.ADN.Viewing.Extension.Physics,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ADN.Viewing.Extension.Physics",Autodesk.ADN.Viewing.Extension.Physics)},function(module,exports,__webpack_require__){"use strict";var _Object$create=__webpack_require__(11)["default"];AutodeskNamespace("Autodesk.ADN.Viewing.Extension"),Autodesk.ADN.Viewing.Extension.TransformTool=function(viewer,options){function TransformTool(){function createTransformMesh(){var material=new THREE.MeshPhongMaterial({color:16711680});viewer.impl.matman().addMaterial(guid(),material,!0);var sphere=new THREE.Mesh(new THREE.SphereGeometry(1e-4,5),material);return sphere.position.set(0,0,0),sphere}function onTxChange(){for(var fragId in _selectedFragProxyMap){var fragProxy=_selectedFragProxyMap[fragId],position=new THREE.Vector3(_transformMesh.position.x-fragProxy.offset.x,_transformMesh.position.y-fragProxy.offset.y,_transformMesh.position.z-fragProxy.offset.z);fragProxy.matrixWorld.setPosition(position)}viewer.impl.sceneUpdated(!0)}function onCameraChanged(){_transformControlTx.update()}function onItemSelected(event){return _selectedFragProxyMap={},event.fragIdsArray.length?void(_hitPoint?(_transformControlTx.visible=!0,_transformControlTx.setPosition(_hitPoint),_transformControlTx.addEventListener("change",onTxChange),viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,onCameraChanged),event.fragIdsArray.forEach(function(fragId){var fragProxy=viewer.impl.getRenderProxy(viewer,fragId),position=getMeshPosition(fragProxy),offset={x:_hitPoint.x-position.x,y:_hitPoint.y-position.y,z:_hitPoint.z-position.z};fragProxy.offset=offset,_selectedFragProxyMap[fragId]=fragProxy}),_hitPoint=null):_transformControlTx.visible=!1):(_hitPoint=null,_transformControlTx.visible=!1,_transformControlTx.removeEventListener("change",onTxChange),void viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,onCameraChanged))}function getMeshPosition(mesh){var pos=new THREE.Vector3;return pos.setFromMatrixPosition(mesh.matrixWorld),pos}function normalize(screenPoint){var viewport=viewer.navigation.getScreenViewport(),n={x:(screenPoint.x-viewport.left)/viewport.width,y:(screenPoint.y-viewport.top)/viewport.height};return n}function getHitPoint(event){var screenPoint={x:event.clientX,y:event.clientY},n=normalize(screenPoint),hitPoint=viewer.utilities.getHitPoint(n.x,n.y);return hitPoint}var _hitPoint=null,_isDragging=!1,_transformMesh=null,_selectedFragProxyMap={},_transformControlTx=null;this.getNames=function(){return["Dotty.Viewing.Tool.TransformTool"]},this.getName=function(){return"Dotty.Viewing.Tool.TransformTool"},this.activate=function(){viewer.select([]);var bbox=viewer.model.getBoundingBox();viewer.impl.createOverlayScene("Dotty.Viewing.Tool.TransformTool"),_transformControlTx=new THREE.TransformControls(viewer.impl.camera,viewer.impl.canvas,"translate"),_transformControlTx.setSize(5*bbox.getBoundingSphere().radius),_transformControlTx.visible=!1,viewer.impl.addOverlay("Dotty.Viewing.Tool.TransformTool",_transformControlTx),_transformMesh=createTransformMesh(),_transformControlTx.attach(_transformMesh),viewer.addEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,onItemSelected)},this.deactivate=function(){viewer.impl.removeOverlay("Dotty.Viewing.Tool.TransformTool",_transformControlTx),_transformControlTx.removeEventListener("change",onTxChange),_transformControlTx=null,viewer.impl.removeOverlayScene("Dotty.Viewing.Tool.TransformTool"),viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,onCameraChanged),viewer.removeEventListener(Autodesk.Viewing.SELECTION_CHANGED_EVENT,onItemSelected)},this.update=function(t){return!1},this.handleSingleClick=function(event,button){return!1},this.handleDoubleClick=function(event,button){return!1},this.handleSingleTap=function(event){return!1},this.handleDoubleTap=function(event){return!1},this.handleKeyDown=function(event,keyCode){return!1},this.handleKeyUp=function(event,keyCode){return!1},this.handleWheelInput=function(delta){return!1},this.handleButtonDown=function(event,button){return _hitPoint=getHitPoint(event),_isDragging=!0,_transformControlTx.onPointerDown(event)?!0:!1},this.handleButtonUp=function(event,button){return _isDragging=!1,_transformControlTx.onPointerUp(event)?!0:!1},this.handleMouseMove=function(event){return _isDragging?_transformControlTx.onPointerMove(event)?!0:!1:_transformControlTx.onPointerHover(event)?!0:!1},this.handleGesture=function(event){return!1},this.handleBlur=function(event){return!1},this.handleResize=function(){}}function guid(){var d=(new Date).getTime(),guid="xxxx-xxxx-xxxx-xxxx-xxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:7&r|8).toString(16)});return guid}Autodesk.Viewing.Extension.call(this,viewer,options);var _self=this;_self.tool=null,_self.load=function(){return _self.tool=new TransformTool,viewer.toolController.registerTool(_self.tool),viewer.toolController.activateTool(_self.tool.getName()),console.log("Autodesk.ADN.Viewing.Extension.TransformTool loaded"),!0},_self.unload=function(){return viewer.toolController.deactivateTool(_self.tool.getName()),console.log("Autodesk.ADN.Viewing.Extension.TransformTool unloaded"),!0}},Autodesk.ADN.Viewing.Extension.TransformTool.prototype=_Object$create(Autodesk.Viewing.Extension.prototype),Autodesk.ADN.Viewing.Extension.TransformTool.prototype.constructor=Autodesk.ADN.Viewing.Extension.TransformTool,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.ADN.Viewing.Extension.TransformTool",Autodesk.ADN.Viewing.Extension.TransformTool)},function(module,exports,__webpack_require__){module.exports={"default":__webpack_require__(12),__esModule:!0}},function(module,exports,__webpack_require__){var $=__webpack_require__(13);module.exports=function(P,D){return $.create(P,D)}},function(module,exports,__webpack_require__){var $Object=Object;module.exports={create:$Object.create,getProto:$Object.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:$Object.getOwnPropertyDescriptor,setDesc:$Object.defineProperty,setDescs:$Object.defineProperties,getKeys:$Object.keys,getNames:$Object.getOwnPropertyNames,getSymbols:$Object.getOwnPropertySymbols,each:[].forEach}}]);